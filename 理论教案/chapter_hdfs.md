### 课时： 4学时理论+2学时实践

***
# 1、教学目标 
    学习理解分布式文件系统的概念，了解计算机集群的结构、分布式文件系统的结构；
    掌握HDFS的设计目标及存在的局限性；
    掌握HDFS１.０的主要相关概念；
    掌握HDFS的体系结构；
    掌握HDFS的存储原理；
    掌握HDFS的数据读写流程；


# 2、教学内容：
## 分布式文件系统理解
    分布式文件系统；
    计算机集群机构；
    HDFS结构；
## HDFS简介
    HDFS的设计目标；
    HDFS的特点；
    HDFS的局限性；
## HDFS主要概念
    块（Block），为什么要使用块；
    元数据，HDFS的元数据是什么；
    名称节点（NameNode），结构-FsImage&EditLog，名称节点的启动过程；
    数据节点（DataNode），作用；
    第二名称节点（SecondaryNameNode），第二名称节点的用途；

## HDFS的体系结构
    整体C/S模式结构；
    信息流转过程；
    命名空间管理；
    通信协议：
        网络模型；
        RPC理解；
    客户端；
    局限性；
## HDFS存储原理
    冗余数据保存；
    数据存取策略；
    数据错误恢复；
## HDFS的读写过程
    首先回顾流式数据读写，引导学生回顾Java所学的InputStream和OutputStream;
    接着讲解如何使用Java编写HDFS文件读写的代码；
    再讲解代码中所用到的Java类，引入回顾Java继承这个知识点；
    讲解完HDFS中文件读写的Java实现后，开始讲解代码背后的文件读写底层过程；

    读数据过程
        打开文件  FileSystem.open()
                    open这个方法返回了FSDataInputStream
                        在DFSInputStream的构造方法中，远程调用了ClientProtocal.getBlockLocations()这个方法，获取文件对应的块存储信息
                            FSDataInputStream.read() 读取文件内容，这里会有一个选择存储节点的过程，原则是就近选择
                                读取完成调用close方法   

    数据写过程
        创建新文件 FileSystem.create()
            create这个方法返回FSDataOutputStream
            DistributedFileSystem这个类会同时通过RPC远程调用名称节点，名称节点会创建一个新文件（首先会执行一个文件创建检查，即是否已经存在该文件），添加该文件的文件信息
                客户端使用FSDataOutputStream调用write方法，开始写数据
                    具体写数据的过程如下：
                        客户端将数据写入过程交给FSDataOutputStream，FSDataOutputStream对象首先把客户端写入的数据分成一个个的分包，之后FSDataOutputStream对象会在内部创建一个队列去管理这些分包。FSDataOutputStream会向名称节点申请获取保存文件本身及副本数据块的相关数据节点。以流水线的形式，将小数据包发送给数据节点。
                            关于流水线的形式的理解：
                                FSDataOutputStream把数据依次发送给第一个数据节点，第一个数据节点接受完成第一个小数据包后，回复ACK，并将第一个小数据包发送给下一个数据节点。以此类推，将所有数据包依次发送给所有数据节点。所有数据节点收到数据包后，都会向FSDataOutputStream对象回复ACK。
                            FSDataOutputStream收到对应数据包的所有ACK后，将对应数据包从队列中清除，当队列为空，被认为数据写入过程完成。
                    写入完成后，调用close方法。
        


***
# 3、教学重点
    主要概念的理解掌握；
    体系结构及存储原理的掌握；
***

# 4、教学难点
    块概念，元数据概念的理解；
    名称节点的启动过程；
    第二名称节点的作用；
    HDFS的读写过程
# 5、教学手段
    多媒体教学；
# 6、教学方法
    启发式教学、讨论、课堂提问等方式；

# 7、课后作业
### 7.1 结合课堂所讲等分布式文件系统以及HDFS特性、优缺点。如果让你设计一个分布式文件系统，你会有那些考虑，设置那些属性并如何统筹这些属性？
### 7.2巩固复习HDFS主节点数据结构和第二名称节点工作流程。要求自己画出HDFS结构以及第二名称节点工作流程。     

# 8、参考资料
# 9、课后小结
    对于一些较为复杂，难以直接理解的部分，要想明白如何讲清楚，而且讲这种模块的时候，要自信，语速要放慢。第一次讲HDFS的文件读取过程，没有讲明白透彻，分析问题：学生接受能力有限，我讲的不够深入，讲解的不够形象，要让学生理解你讲的内容，如何更好的理解，这是重点。
    基础知识点，环环相扣，引申出来很重要。

    如何讲好重点难点？
        可能自己明白，但是确感觉学生听的似懂非懂的，这种情况大致可以定性为没有讲明白；
        除了靠语言说，使用ppt做形象化的图片也非常重要。